# Hello Helm - Full Stack Application with Kubernetes

A full-stack application (FastAPI backend + Next.js frontend + PostgreSQL) demonstrating how to deploy with **Helm charts** on Kubernetes.

## üéØ Project Overview

This project showcases:
- **FastAPI Backend** with PostgreSQL database
- **Next.js Frontend** (React)
- **Nginx** reverse proxy
- **Helm Charts** for Kubernetes deployment
- **Docker Compose** for local development

## üìÅ Project Structure

```
hello-helm/
‚îú‚îÄ‚îÄ backend/                    # FastAPI application
‚îÇ   ‚îú‚îÄ‚îÄ app/                   # Application code
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile             # Dev dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.prod        # Production dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ pyproject.toml         # Python dependencies (uv)
‚îÇ
‚îú‚îÄ‚îÄ frontend/                   # Next.js application
‚îÇ   ‚îî‚îÄ‚îÄ (frontend code)
‚îÇ
‚îú‚îÄ‚îÄ nginx/                      # Nginx configuration
‚îÇ   ‚îî‚îÄ‚îÄ (nginx config)
‚îÇ
‚îú‚îÄ‚îÄ helm_charts/               # Kubernetes Helm Charts
‚îÇ   ‚îú‚îÄ‚îÄ backend/              # Backend + PostgreSQL chart
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Chart.yaml
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ values.yaml
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ values-local.yaml
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deployment.yaml
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service.yaml
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ postgres-statefulset.yaml
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ postgres-service.yaml
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ postgres-secret.yaml
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ QUICK-START.md    # 5-minute deployment guide
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ README.md          # Complete chart documentation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ STRUCTURE.md       # Chart structure deep-dive
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ frontend/              # Frontend chart
‚îÇ       ‚îî‚îÄ‚îÄ (similar structure)
‚îÇ
‚îú‚îÄ‚îÄ compose.yml                # Docker Compose for local dev
‚îÇ
‚îú‚îÄ‚îÄ docs/                       # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ HELM-LEARNING-GUIDE.md      # üìö Complete learning guide
‚îÇ   ‚îú‚îÄ‚îÄ DEPLOYMENT.md               # Deployment instructions
‚îÇ   ‚îú‚îÄ‚îÄ DOCKER-COMPOSE-VS-HELM.md   # Concept comparison
‚îÇ   ‚îî‚îÄ‚îÄ MAKEFILE-GUIDE.md           # Makefile commands reference
‚îÇ
‚îî‚îÄ‚îÄ README.md                   # This file
```

## üöÄ Quick Start

### Option 1: Local Development with Docker Compose

```bash
docker-compose up
```

Access:
- Frontend: http://localhost:80
- Backend: http://localhost:80/api
- Backend docs: http://localhost:80/api/docs

### Option 2: Kubernetes with Helm

**Prerequisites:**
- Docker
- Kubernetes (minikube/kind/Docker Desktop)
- Helm 3.x
- kubectl

**Deploy in 3 commands:**

```bash
# 1. Build & load image
cd backend
docker build -f Dockerfile.prod -t backend-app:latest .
minikube image load backend-app:latest  # or: kind load docker-image backend-app:latest

# 2. Deploy with Helm
cd ../helm_charts/backend
helm install my-backend .

# 3. Access the application
kubectl port-forward svc/my-backend 8000:8000
```

Visit: http://localhost:8000/docs

## üìö Documentation

### üéì Learning Helm Charts (Start Here!)

1. **[docs/HELM-LEARNING-GUIDE.md](docs/HELM-LEARNING-GUIDE.md)** ‚≠ê
   - Complete learning path (Beginner ‚Üí Advanced)
   - Understand Helm concepts
   - Key takeaways and best practices

2. **[helm_charts/backend/QUICK-START.md](helm_charts/backend/QUICK-START.md)**
   - Deploy in 5 minutes
   - Perfect for first-time users

3. **[docs/DEPLOYMENT.md](docs/DEPLOYMENT.md)**
   - Comprehensive deployment guide
   - Step-by-step instructions
   - Troubleshooting tips

### üìñ Understanding the Architecture

4. **[docs/DOCKER-COMPOSE-VS-HELM.md](docs/DOCKER-COMPOSE-VS-HELM.md)**
   - Compare Docker Compose to Kubernetes/Helm
   - Concept mapping
   - When to use what

5. **[helm_charts/backend/STRUCTURE.md](helm_charts/backend/STRUCTURE.md)**
   - Deep dive into Helm chart structure
   - Template syntax
   - Values flow

### üìò Reference

6. **[helm_charts/backend/README.md](helm_charts/backend/README.md)**
   - Complete chart documentation
   - Configuration options
   - Customization examples

## üèóÔ∏è Architecture

### Development (Docker Compose)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           Docker Compose             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  ‚îÇ Nginx   ‚îÇ  ‚îÇ Backend ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ :80     ‚îÇ‚Üí ‚îÇ :8000   ‚îÇ           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îÇ                ‚îÇ
‚îÇ  ‚îÇFrontend ‚îÇ       ‚îÇ                ‚îÇ
‚îÇ  ‚îÇ :3000   ‚îÇ       ‚Üì                ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îÇ
‚îÇ               ‚îÇPostgres  ‚îÇ          ‚îÇ
‚îÇ               ‚îÇ :5432    ‚îÇ          ‚îÇ
‚îÇ               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Production (Kubernetes + Helm)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Kubernetes Cluster                   ‚îÇ
‚îÇ                                                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ Backend Deploy   ‚îÇ  ‚îÇ Frontend Deploy    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ  ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚îÇ Pod ‚îÇ Pod ‚îÇ..‚îÇ‚îÇ ‚îÇ  ‚îÇ ‚îÇ Pod ‚îÇ Pod ‚îÇ... ‚îÇ ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ  ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ           ‚îÇ                       ‚îÇ              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ Backend Service  ‚îÇ  ‚îÇ Frontend Service  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ClusterIP :8000  ‚îÇ  ‚îÇ ClusterIP :3000   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ           ‚îÇ                                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                   ‚îÇ
‚îÇ  ‚îÇ PostgreSQL StatefulSet   ‚îÇ                   ‚îÇ
‚îÇ  ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ                   ‚îÇ
‚îÇ  ‚îÇ ‚îÇ postgres-0           ‚îÇ ‚îÇ                   ‚îÇ
‚îÇ  ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ                   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îÇ
‚îÇ           ‚îÇ                                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                           ‚îÇ
‚îÇ  ‚îÇ PVC (1Gi)        ‚îÇ                           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üõ†Ô∏è Technology Stack

### Backend
- **FastAPI** - Modern Python web framework
- **SQLAlchemy** - ORM with async support
- **PostgreSQL 15** - Database
- **Uvicorn** - ASGI server
- **Pydantic** - Data validation
- **uv** - Fast Python package manager

### Frontend
- **Next.js** - React framework
- **TypeScript** - Type safety
- **Tailwind CSS** - Styling

### Infrastructure
- **Docker** - Containerization
- **Kubernetes** - Orchestration
- **Helm** - Package management
- **Nginx** - Reverse proxy

## üì¶ Backend Dependencies

```toml
[project]
dependencies = [
    "asyncpg>=0.30.0",
    "fastapi[standard]>=0.118.0",
    "pydantic>=2.11.10",
    "pydantic-settings>=2.11.0",
    "sqlmodel>=0.0.25",
    "uvicorn>=0.37.0",
]
```

## üîí Security Notes

‚ö†Ô∏è **For Production:**

1. **Secrets Management**
   - Don't store passwords in `values.yaml`
   - Use Kubernetes Secrets with encryption at rest
   - Consider external secret managers (Vault, AWS Secrets Manager)

2. **Image Security**
   - Use specific version tags, not `latest`
   - Scan images for vulnerabilities
   - Use minimal base images

3. **Network Security**
   - Implement Network Policies
   - Use TLS/SSL for all connections
   - Restrict service-to-service communication

4. **Access Control**
   - Enable RBAC
   - Use least privilege principle
   - Regular security audits

## üß™ Testing

### Test Backend Locally

```bash
# With Docker Compose
docker-compose up backend postgres

# Test endpoints
curl http://localhost:8000/health
curl http://localhost:8000/items

# API docs
open http://localhost:8000/docs
```

### Test in Kubernetes

```bash
# Deploy
helm install test-backend helm_charts/backend/

# Port forward
kubectl port-forward svc/test-backend 8000:8000

# Test
curl http://localhost:8000/health

# Cleanup
helm uninstall test-backend
```

## üêõ Troubleshooting

### Docker Compose Issues

```bash
# View logs
docker-compose logs backend
docker-compose logs postgres

# Restart services
docker-compose restart backend

# Clean up
docker-compose down -v
```

### Kubernetes Issues

```bash
# Check pod status
kubectl get pods

# View logs
kubectl logs -l app.kubernetes.io/name=backend

# Describe pod for events
kubectl describe pod <pod-name>

# Delete and recreate
helm uninstall my-backend
helm install my-backend helm_charts/backend/
```

See [DEPLOYMENT.md](DEPLOYMENT.md) for detailed troubleshooting.

## üìä Monitoring & Observability

### Logs

```bash
# Docker Compose
docker-compose logs -f backend

# Kubernetes
kubectl logs -l app.kubernetes.io/name=backend -f
```

### Metrics

For production, consider adding:
- **Prometheus** - Metrics collection
- **Grafana** - Visualization
- **Loki** - Log aggregation
- **Jaeger** - Distributed tracing

## üö¢ CI/CD

Suggested pipeline:

```
1. Code Push
   ‚Üì
2. Run Tests
   ‚Üì
3. Build Docker Image
   ‚Üì
4. Push to Registry
   ‚Üì
5. Update Helm Values
   ‚Üì
6. Deploy to Staging
   ‚Üì
7. Run Integration Tests
   ‚Üì
8. Deploy to Production (manual approval)
```

## üìù Development Workflow

### Making Changes

1. **Edit code** in `backend/app/`
2. **Test locally** with Docker Compose
3. **Build new image** with version tag
4. **Update Helm values** with new tag
5. **Deploy to dev cluster** and test
6. **Deploy to production** when ready

### Example

```bash
# 1. Make changes
vim backend/app/main.py

# 2. Test with compose
docker-compose up backend

# 3. Build with version
docker build -f backend/Dockerfile.prod -t backend-app:v1.2.3 .

# 4. Load into cluster
minikube image load backend-app:v1.2.3

# 5. Deploy
helm upgrade my-backend helm_charts/backend/ \
  --set image.tag=v1.2.3
```

## ü§ù Contributing

This is a learning project following your company's Helm chart pattern:
- Each component gets its own chart
- Charts are independent and versioned separately
- Shared values through parent charts or external configuration

## üìÑ License

This is a practice/learning project.

## üéì Learning Resources

- [Helm Official Docs](https://helm.sh/docs/)
- [Kubernetes Documentation](https://kubernetes.io/docs/)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Next.js Documentation](https://nextjs.org/docs)

## üÜò Need Help?

1. Check **[HELM-LEARNING-GUIDE.md](HELM-LEARNING-GUIDE.md)** for comprehensive guidance
2. Review **[DEPLOYMENT.md](DEPLOYMENT.md)** for deployment issues
3. Read component-specific READMEs in `helm_charts/`
4. Check troubleshooting sections in each guide

## üéØ Next Steps

- [ ] Deploy backend with Helm ‚úÖ (follow QUICK-START.md)
- [ ] Create frontend Helm chart (similar pattern)
- [ ] Add Ingress for external access
- [ ] Set up monitoring (Prometheus/Grafana)
- [ ] Implement CI/CD pipeline
- [ ] Add automated tests
- [ ] Document runbooks for operations

---

**Happy Learning!** üöÄ‚éà

For a complete learning experience, start with [docs/HELM-LEARNING-GUIDE.md](docs/HELM-LEARNING-GUIDE.md)!

